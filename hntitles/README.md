# GPT-3 Hacker News

This is the [@HNTitles@botsin.space](https://botsin.space/@HNTitles) bot.

All titles posted by this bot are fake, generated by the GPT-3 Ada model, fine-tuned with 10,000 real titles from the past year, selected randomly from submissions that got at least 30 points.

Each post costs around $0.0000448 to generate.

We used Ada because titles generated by the larger Curie model are barely distinguishable from the real thing, despite being original.

This is the successor of [@HNTitles](https://twitter.com/HNTitles), which posted
titles generated with a rudimentary Markov chain for nine years, from 2013 to
2022. Its source is archived at
[github.com/FiloSottile/HNTitles](https://github.com/FiloSottile/HNTitles).

The bot runs entirely on GitHub Actions.

You can browse generated Hacker News titles at [filippo.io/fakenews](https://filippo.io/fakenews), too.

## Training notes

We got the titles from the Algolia HN search API

```
curl 'https://hn.algolia.com/api/v1/search_by_date?tags=story&numericFilters=points>30,created_at_i<1645889394&hitsPerPage=1000' | jq -r '.hits[] | .title  + " (" + (.points | tostring) + " points, " + (.num_comments | tostring) + " comments)"' >> training.txt
```

and converted formatted them as JSON Lines with jq

```
jq -cR 'split("\n") | .[] | { prompt: "A plausible Hacker News title:", completion: (" " + . + " END") }' training.txt > training.jsonl
```

and fed them to the very well built and documented openai CLI. 

A training line looks like this

```
{"prompt": "A plausible Hacker News title:", "completion": " The Feynman Lectures on Physics (1964) (280 points, 62 comments) END"}
```

The space at the beginning of the completion is for tokenizing, and the END token is for use as a stop token in the generations.

Generations can be produced with the CLI

```
openai api completions.create -m curie:ft-personal:hntitles-2022-11-26-18-22-18 -p "A plausible Hacker News title:" --stop END -M 30 -n 10 -t 0.9
```

or the API, which is what the bot does.

```
curl https://api.openai.com/v1/completions \
  -H 'Content-Type: application/json' \
  -H "Authorization: Bearer $OPENAI_API_KEY" \
  -d '{
  "model": "ada:ft-personal:hntitles-2022-11-26-17-58-24",
  "prompt": "A plausible Hacker News title:",
  "max_tokens": 50,
  "temperature": 0.9,
  "n": 15,
  "stop": "END"
}'
```
