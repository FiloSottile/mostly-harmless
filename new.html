<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>
            Superfish CA + Komodia vulnerability test
        </title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="bootstrap/css/bootstrap.css" rel="stylesheet" type="text/css">
        <link href="css/flat-ui.css" rel="stylesheet" type="text/css">
        <!--[if lt IE 9]>
            <script src="js/html5shiv.js"></script>
            <script src="js/respond.min.js"></script>
        <![endif]-->

        <style>
html {
  position: relative;
  min-height: 100%;
}
body {
  margin-bottom: 80px;
}
#footer {
  position: absolute;
  bottom: 0;
  width: 100%;
  height: 70px;
  background-color: #f5f5f5;
}

.container {
  width: auto;
  max-width: 900px;
  padding: 0 15px;
}
.container .text-muted {
  margin: 20px 0;
}

.result {
    text-align: center;
    border: 1px solid #34495E;
    -webkit-border-radius: 5px;
    -moz-border-radius: 5px;
    border-radius: 5px;
}

        </style>
    </head>
    <body>

        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-37225193-1', 'auto');
          ga('send', 'pageview');

        </script>

        <div class="container">
        <div class="page-header">
            <h1>
                Superfish CA + Komodia vulnerability test (updated!)
            </h1>
        </div>
        <p class="lead">
            Check the box below. If you see a "YES", you have a problem.<br>
            <b style="font-size: 70%">Do the test with all browsers installed.</b>
        </p>

        <p class="lead result" id="starting">
            The test will start in 10 seconds.<br>
            If you are asked to accept/approve/trust a certificate, answer No.<br>
            If a button to "Load content" appears, don't click it.
        </p>

        <p class="lead result" id="san" style="display: none;">
            YES, it looks like you have a Komodia<br> proxy running (but not Superfish).
            <br><br>
            Unfortunately there aren't detailed removal instructions at the moment, but here is an incomplete list of known affected softwares: "Keep My Family Secure", "Kurupira", "Qustodio", "Staffcop", "Easy hide IP Classic", "Lavasoft Ad-aware Web Companion".
        </p>
        <p class="lead result" id="self" style="display: none;">
            YES, you have a problem - even if it's not Komodia.<br><br>
            Apparently the browser you are using is not checking certificates. That's BAD. Anyone can intercept the connections you make from this browser. If you can, get in contact with the app/browser developer, and/or avoid using it.
            If this is a corporate machine, get in contact with the company IT.
        </p>
        <p class="lead result" id="super" style="display: none;">
            <img src="yes.png" alt="Yes, your connections can be tampered with!" style="width: 300px; margin: 20px"><br>
            See <a href="removing.html">here</a> for instructions on removal.
        </p>
        <p class="lead result" id="good" style="display: none;">
            <img src="no2.png" alt="Good, you seem not to trust the Superfish CA." style="width: 500px"><br>
            Also no other Komodia product was detected on your system.
        </p>

        <p>
            <b>What's this about?</b> Turns out Lenovo preloaded their laptops with adware that will intercept all your secure connections, and allow hackers to do it, too. The same vulnerable system is used by other software too, like some Parental Controls. This is a test to check if you are affected.
        </p>

        <p>
            Thanks to Karl Koscher, Paul Pearce, Marc Rogers and all the others that discovered and divulged this.
        </p>

        </div>
        <div id="footer">
            <div class="container">
                <p class="text-muted">
                    Built in a frenzy by <a href="https://filippo.io">Filippo Valsorda</a>.
                    <a href="https://twitter.com/FiloSottile">Twitter</a>,
                    <a href="https://blog.filippo.io">Blog</a>.
                </p>
            </div>
        </div>
        <!-- Load JS here for greater good =============================-->
        <script src="js/jquery-1.8.3.min.js" type="text/javascript"></script>

        <script>
        window.setTimeout(function() {
            [
              'https://san.filippo.io/yes.js?cachekill=' + Math.random(),
              'https://selfsigned.filippo.io/yes.js?cachekill=' + Math.random(),
              'https://badfish.filippo.io/yes.js?cachekill=' + Math.random(),
              'finally.js'
            ].forEach(function(src) {
              var script = document.createElement('script');
              script.src = src;
              script.async = false;
              document.head.appendChild(script);
            });
        }, 10000);

        function loadedNew() {
            $('#starting').hide();
            ga('send', 'event', 'New - Loaded', {'nonInteraction': 1});
        }

        function triggeredSelf() {
            $('#self').show();
            ga('send', 'event', 'New - Result', 'Selfsigned', {'nonInteraction': 1});
        }
        function triggeredSuper() {
            $('#super').show();
            ga('send', 'event', 'New - Result', 'Superfish', {'nonInteraction': 1});
        }
        function triggeredSan() {
            $('#san').show();
            ga('send', 'event', 'New - Result', 'SAN only', {'nonInteraction': 1});
        }
        function allGood() {
            $('#good').show();
            ga('send', 'event', 'New - Result', 'Good', {'nonInteraction': 1});
        }
        </script>

    </body>
</html>
